---
- name: List jobs in AAP
  hosts: localhost
  gather_facts: false
  collections:
    - ansible.controller
  vars:
    controller_host: "https://51.20.108.56"
    controller_username: "admin"
    controller_password: "chanukya123"
    validate_certs: false

  tasks:
    - name: Get job list from AAP
      ansible.controller.job_list:
      register: jobs

    - name: Show job IDs
      ansible.builtin.debug:
        msg: "Found job with ID={{ item.id }}"
      loop: "{{ jobs.results | default(jobs.json.results | default([])) }}"

    - name: Get details for each job
      ansible.controller.job_info:
        id: "{{ item.id }}"
      loop: "{{ jobs.results | default(jobs.json.results | default([])) }}"
      register: job_details

    - name: Show concise job summary (ID, Name, Status)
      ansible.builtin.debug:
        msg: "Job ID={{ item.id }} | Name='{{ item.name }}' | Status={{ item.status }}"
      loop: "{{ job_details.results | map(attribute='jobs.0') | list }}"





      

 


